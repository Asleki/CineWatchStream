<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CineWatch - Homepage</title>
  
  <!-- Font Awesome CDN for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <!-- Inter Font (for consistent typography across the site) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Consolidated Main Stylesheet - Only styles relevant to header, footer, search area, and general body -->
  <style>
    /* Root Theme Variables */
    :root {
      --bg: #fff;
      --text: #111;
      --header-bg: #f0ecec;
      --search-bg: #f4f4f4;
      --card-border: #eee; /* Used for header/footer borders */
      --card-shadow: rgba(0, 0, 0, 0.05); /* Used for header shadow */
      --highlight: #007bff;
      --accent: #28a745;
      --danger: #dc3545;
      --info: #17a2b8;
      --warning: #ffc107;
      --modal-bg: rgba(0, 0, 0, 0.5);
      --modal-content-bg: #fff;
      --modal-text: #111;
      --search-area-height: 120px; /* Approximate height of expanded search area */

      /* New Variables for Homepage Content */
      --hero-overlay: rgba(0, 0, 0, 0.6);
      --section-padding: 40px 20px;
      --carousel-gap: 20px;
      --card-bg: #fff;
      --card-text: #111;
      --card-rating-bg: var(--accent);
      --card-rating-text: #fff;
      --button-hover: #0056b3;

      /* Search Suggestions */
      --suggestions-bg: #fff;
      --suggestions-border: #ddd;
      --suggestions-item-hover-bg: #f0f0f0;

      /* Carousel Specific */
      --carousel-arrow-bg: rgba(0, 0, 0, 0.5);
      --carousel-arrow-color: #fff;
      --carousel-arrow-hover-bg: rgba(0, 0, 0, 0.7);
    }

    /* Dark Mode Variables */
    body.dark-mode {
      --bg: #1a1a1a;
      --text: #f0f0f0;
      --header-bg: #2a2a2a;
      --search-bg: #333;
      --card-border: #444;
      --card-shadow: rgba(0, 0, 0, 0.3);
      --highlight: #66b3ff;
      --accent: #4CAF50;
      --danger: #ff6b6b;
      --info: #00bcd4;
      --warning: #ffeb3b;
      --modal-bg: rgba(0, 0, 0, 0.7);
      --modal-content-bg: #282828;
      --modal-text: #f0f0f0;

      /* Dark Mode for New Homepage Content */
      --hero-overlay: rgba(0, 0, 0, 0.75);
      --card-bg: #282828;
      --card-text: #f0f0f0;
      --card-rating-bg: var(--accent);
      --card-rating-text: #fff;
      --button-hover: #4a90d9;

      /* Search Suggestions Dark Mode */
      --suggestions-bg: #282828;
      --suggestions-border: #444;
      --suggestions-item-hover-bg: #3a3a3a;

      /* Carousel Specific Dark Mode */
      --carousel-arrow-bg: rgba(255, 255, 255, 0.2);
      --carousel-arrow-color: #f0f0f0;
      --carousel-arrow-hover-bg: rgba(255, 255, 255, 0.3);
    }

    /* Global Styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      transition: background-color 0.3s, color 0.3s;
      line-height: 1.6;
      min-height: 100vh; /* Ensures body takes full viewport height */
      display: flex;
      flex-direction: column; /* Allows main content to push footer down */
    }

    a {
      color: var(--highlight);
      text-decoration: none;
      transition: color 0.2s ease;
    }

    a:hover {
      color: var(--accent);
    }

    /* Accessibility: Focus styles */
    :focus-visible {
      outline: 2px solid var(--highlight);
      outline-offset: 2px;
    }

    /* Global Header Wrapper */
    .main-global-header {
      background-color: var(--header-bg);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
      transition: background-color 0.3s, box-shadow 0.3s;
    }

    /* Utility Header (Top Row) */
    .utility-header {
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--card-border); /* Separator */
    }

    .logo a {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--highlight);
      text-transform: capitalize; /* Ensures initial caps as requested */
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    .header-utility-actions {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .search-bar-toggle button {
        background: none;
        border: none;
        color: var(--text);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 5px;
        border-radius: 50%;
        transition: background-color 0.2s ease;
    }

    .search-bar-toggle button:hover {
        background-color: rgba(0, 0, 0, 0.05);
    }

    .account-menu {
      position: relative;
    }

    .account-button {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 5px;
      border-radius: 50%;
      transition: background-color 0.2s ease;
      display: flex; /* Centers the icon */
      align-items: center;
      justify-content: center;
    }

    .account-button:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .theme-toggle-button { /* New class for dark mode toggle */
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 5px;
      border-radius: 50%;
      transition: background-color 0.2s ease;
      display: flex; /* Centers the icon */
      align-items: center;
      justify-content: center;
    }

    .theme-toggle-button:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .account-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background-color: var(--header-bg);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      min-width: 180px;
      padding: 10px 0;
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
    }

    .account-dropdown.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .account-dropdown a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 15px;
      color: var(--text);
      font-size: 0.95rem;
      white-space: nowrap;
      transition: background-color 0.2s ease, color 0.2s ease;
    }

    .account-dropdown a:hover {
      background-color: rgba(0, 0, 0, 0.05);
      color: var(--highlight);
    }

    .account-dropdown a i {
      width: 20px; /* Ensures consistent icon alignment */
      text-align: center;
    }

    .mobile-menu-toggle {
      display: none; /* Hidden by default on desktop */
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
    }

    /* Main Navigation Header (Bottom Row - Desktop Nav) */
    .main-nav-header {
      padding: 10px 20px;
      display: flex;
      justify-content: center;
      gap: 30px;
      align-items: center;
    }

    .main-nav-header a {
      font-weight: 500;
      color: var(--text);
      font-size: 1rem;
      position: relative;
      padding: 5px 0;
    }

    .main-nav-header a::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: 0;
      width: 0;
      height: 2px;
      background-color: var(--highlight);
      transition: width 0.3s ease;
    }

    .main-nav-header a:hover::after {
      width: 100%;
    }

    /* Dynamic Search Area */
    .dynamic-search-area {
      background-color: var(--header-bg);
      padding: 15px 20px;
      overflow: hidden;
      max-height: 0; /* Initially hidden */
      opacity: 0;
      transition: max-height 0.4s ease-out, opacity 0.4s ease-out;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      position: relative; /* For positioning search suggestions */
    }

    .dynamic-search-area.show {
      max-height: var(--search-area-height); /* Expands to reveal */
      opacity: 1;
    }

    .search-input-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px; /* Space between input and filters */
      position: relative; /* For suggestions container positioning */
      z-index: 1050; /* Ensure search bar is above suggestions */
    }

    .dynamic-search-area input[type="text"] {
      flex-grow: 1;
      padding: 10px 15px;
      border: 1px solid var(--card-border);
      border-radius: 25px;
      background-color: var(--search-bg);
      color: var(--text);
      font-size: 1rem;
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    .dynamic-search-area input[type="text"]:focus {
      border-color: var(--highlight);
      box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
      outline: none;
    }

    .search-icon-btn {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.2rem;
      cursor: pointer;
      padding: 5px;
      transition: color 0.2s ease;
    }
    .search-icon-btn:hover {
        color: var(--highlight);
    }

    .search-button-label {
      background-color: var(--highlight);
      color: #fff;
      padding: 8px 15px;
      border: none;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .search-button-label:hover {
      background-color: #0056b3;
    }

    .search-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center; /* Centers filters */
    }

    .search-filters select,
    .search-filters input[type="text"] {
      padding: 8px 12px;
      border: 1px solid var(--card-border);
      border-radius: 10px;
      background-color: var(--search-bg);
      color: var(--text);
      font-size: 0.9rem;
      min-width: 120px;
      flex: 1; /* Allows items to grow/shrink */
      max-width: 200px; /* Max width for filter inputs */
    }

    /* Search Suggestions Dropdown */
    .search-suggestions-container {
        position: absolute;
        top: calc(100% + 5px); /* Position below the search bar */
        left: 0;
        right: 0;
        background-color: var(--suggestions-bg);
        border: 1px solid var(--suggestions-border);
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        max-height: 250px;
        overflow-y: auto;
        z-index: 1000; /* Below search bar, above other content */
        display: none; /* Hidden by default */
    }

    .search-suggestions-container.show {
        display: block;
    }

    .search-suggestion-item {
        display: flex;
        align-items: center;
        padding: 10px 15px;
        cursor: pointer;
        transition: background-color 0.2s ease;
        border-bottom: 1px solid var(--suggestions-border);
    }

    .search-suggestion-item:last-child {
        border-bottom: none;
    }

    .search-suggestion-item:hover {
        background-color: var(--suggestions-item-hover-bg);
    }

    .search-suggestion-item img {
        width: 40px;
        height: 60px;
        object-fit: cover;
        border-radius: 5px;
        margin-right: 10px;
        flex-shrink: 0; /* Prevent image from shrinking */
    }

    .search-suggestion-info {
        flex-grow: 1;
        color: var(--text);
    }

    .search-suggestion-info h4 {
        font-size: 1rem;
        margin-bottom: 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .search-suggestion-info p {
        font-size: 0.85rem;
        color: var(--text);
        opacity: 0.7;
    }


    /* Main Content Area - acts as a flexible spacer */
    main {
        flex-grow: 1; /* Pushes footer to the bottom */
        display: flex;
        flex-direction: column; /* Stack content vertically */
        padding: 0; /* No padding here, sections will have their own */
        color: var(--text);
    }

    /* Hero Section Styles */
    .hero-section {
        position: relative;
        width: 100%;
        height: 500px; /* Adjust height as needed */
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        color: #fff;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        margin-bottom: 40px;
        transition: background-image 0.5s ease-in-out;
    }

    .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--hero-overlay);
        z-index: 1;
    }

    .hero-content {
        position: relative;
        z-index: 2;
        max-width: 800px;
        margin-left: 5%; /* Align content to the left */
        padding: 20px;
    }

    .hero-content h1 {
        font-size: 3.5rem;
        margin-bottom: 15px;
        line-height: 1.1;
    }

    .hero-content p {
        font-size: 1.2rem;
        margin-bottom: 25px;
        max-width: 600px;
    }

    .hero-buttons .btn {
        background-color: var(--highlight);
        color: #fff;
        padding: 12px 25px;
        border-radius: 8px;
        font-weight: 600;
        margin-right: 15px;
        transition: background-color 0.2s ease, transform 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }

    .hero-buttons .btn:hover {
        background-color: var(--button-hover);
        transform: translateY(-2px);
    }

    .hero-quote-card {
        position: absolute;
        bottom: 20px;
        right: 20px;
        background-color: rgba(0, 0, 0, 0.7);
        color: #fff;
        padding: 15px 20px;
        border-radius: 10px;
        max-width: 300px;
        font-style: italic;
        font-size: 0.9rem;
        text-align: right;
        z-index: 2;
    }

    /* Content Section Styles (Carousels/Grids) */
    .content-section {
        padding: var(--section-padding);
        margin-bottom: 30px;
    }

    .content-section h2 {
        font-size: 2rem;
        margin-bottom: 25px;
        text-align: center;
        color: var(--text);
        position: relative;
        padding-bottom: 10px;
    }

    .content-section h2::after {
        content: '';
        position: absolute;
        left: 50%;
        bottom: 0;
        transform: translateX(-50%);
        width: 80px;
        height: 3px;
        background-color: var(--highlight);
        border-radius: 2px;
    }

    /* Carousel Container */
    .show-carousel {
        position: relative;
        max-width: 1200px; /* Match max-width of previous grid */
        margin: 0 auto; /* Center the carousel */
        overflow: hidden; /* Hide overflowing cards */
        padding: 0 40px; /* Space for arrows */
    }

    /* Carousel Inner - holds the cards */
    .show-carousel-inner {
        display: flex;
        overflow-x: scroll; /* Enable horizontal scrolling */
        scroll-behavior: smooth; /* Smooth scrolling for navigation */
        -webkit-overflow-scrolling: touch; /* Enhance touch scrolling */
        scrollbar-width: none; /* Hide scrollbar for Firefox */
        /* For Webkit (Chrome, Safari, Edge) */
        &::-webkit-scrollbar {
            display: none;
        }
        gap: var(--carousel-gap); /* Gap between cards */
        padding-bottom: 20px; /* Space for potential scrollbar area, even if hidden */
    }

    /* Carousel Navigation Arrows */
    .carousel-arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: var(--carousel-arrow-bg);
        color: var(--carousel-arrow-color);
        border: none;
        padding: 15px 10px;
        cursor: pointer;
        font-size: 1.5rem;
        border-radius: 8px; /* Rounded corners */
        z-index: 100; /* Above cards */
        transition: background-color 0.2s ease, transform 0.2s ease;
        opacity: 0.8;
    }

    .carousel-arrow:hover {
        background-color: var(--carousel-arrow-hover-bg);
        opacity: 1;
        transform: translateY(-50%) scale(1.05);
    }

    .carousel-arrow.left {
        left: 0px; /* Align to the edge of the carousel container */
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }

    .carousel-arrow.right {
        right: 0px; /* Align to the edge of the carousel container */
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    /* Show Card for Carousels */
    .show-card {
        flex: 0 0 auto; /* Do not grow, do not shrink, base on content */
        width: 180px; /* Fixed width for carousel items */
        background-color: var(--card-bg);
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 10px var(--card-shadow);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        display: flex;
        flex-direction: column;
        height: 100%; /* Ensures cards in a row have similar height */
        position: relative;
    }

    .show-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
    }

    .show-card a { /* Make the entire card clickable */
        display: flex;
        flex-direction: column;
        height: 100%;
        text-decoration: none; /* Remove underline from card link */
        color: inherit; /* Inherit text color */
    }

    .show-card-poster {
        width: 100%;
        height: 270px; /* Fixed height for posters */
        object-fit: cover;
        display: block;
        transition: opacity 0.3s ease;
    }

    /* Fallback for missing images */
    .show-card.no-image .show-card-poster {
        display: none; /* Hide the broken image icon */
    }

    .show-card.no-image .show-card-content::before {
        content: 'No Image Available';
        display: flex;
        align-items: center;
        justify-content: center;
        height: 270px; /* Match poster height */
        background-color: var(--card-border);
        color: var(--text);
        font-size: 1rem;
        text-align: center;
        border-bottom: 1px solid var(--card-border);
        opacity: 0.7;
    }

    .show-card-content {
        padding: 15px;
        display: flex;
        flex-direction: column;
        flex-grow: 1; /* Allows content to push footer down within card */
    }

    .show-card-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--card-text);
        margin-bottom: 8px;
        line-height: 1.3;
    }

    .show-card-meta {
        font-size: 0.9rem;
        color: var(--text);
        opacity: 0.8;
        margin-bottom: 10px;
    }

    .show-card-meta span {
        margin-right: 10px;
    }

    .show-card-rating {
        position: absolute;
        top: 10px;
        left: 10px;
        background-color: var(--card-rating-bg);
        color: var(--card-rating-text);
        padding: 5px 8px;
        border-radius: 5px;
        font-size: 0.8rem;
        font-weight: 600;
        z-index: 10; /* Above poster */
    }

    .show-card-buttons {
        margin-top: auto; /* Pushes buttons to the bottom */
        display: flex;
        justify-content: space-around;
        gap: 10px;
        padding-top: 10px;
        border-top: 1px solid var(--card-border);
        margin-top: 15px;
    }

    .show-card-buttons .btn-details {
        background-color: var(--highlight);
        color: #fff;
        padding: 8px 12px;
        border-radius: 5px;
        font-size: 0.9rem;
        transition: background-color 0.2s ease;
        flex-grow: 1;
        text-align: center;
    }

    .show-card-buttons .btn-details:hover {
        background-color: var(--button-hover);
    }

    /* Load More Button */
    .load-more-btn-wrapper {
        text-align: center;
        margin-top: 20px;
    }

    .load-more-btn {
        background-color: var(--accent);
        color: white;
        padding: 10px 20px;
        border-radius: 8px;
        font-weight: 600;
        text-decoration: none;
        transition: background-color 0.2s ease, transform 0.2s ease;
        display: inline-block; /* Allows padding and margins */
    }

    .load-more-btn:hover {
        background-color: #218838; /* Darker green */
        transform: translateY(-2px);
    }


    /* Modal / Custom Alert Box */
    .custom-alert {
      display: none; /* Hidden by default */
      position: fixed;
      z-index: 2000; /* High z-index to be on top */
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: var(--modal-bg);
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .custom-alert.show {
      display: flex; /* Shows when active */
      opacity: 1;
      visibility: visible;
    }

    .alert-content {
      background-color: var(--modal-content-bg);
      margin: auto;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      text-align: center;
      max-width: 400px;
      width: 90%;
      position: relative;
      transform: translateY(-20px);
      transition: transform 0.3s ease;
    }

    .custom-alert.show .alert-content {
      transform: translateY(0);
    }

    .alert-icon {
      font-size: 3rem;
      margin-bottom: 20px;
    }

    .alert-icon.red-icon { color: var(--danger); }
    .alert-icon.blue-icon { color: var(--info); }
    .alert-icon.green-icon { color: var(--accent); }
    .alert-icon.yellow-icon { color: var(--warning); }


    #alertMessage {
      font-size: 1.1rem;
      color: var(--modal-text);
      margin-bottom: 20px;
    }

    #closeAlertBtn {
      background-color: var(--highlight);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.2s ease;
    }

    #closeAlertBtn:hover {
      background-color: #0056b3;
    }


    /* Footer */
    .main-footer {
      background-color: var(--header-bg);
      color: var(--text);
      padding: 30px 20px;
      text-align: center;
      border-top: 1px solid var(--card-border);
      font-size: 0.9rem;
      /* Removed margin-top: auto; as main flex-grow handles spacing */
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 20px;
    }

    .footer-section {
      flex: 1 1 200px;
      margin-bottom: 20px;
      text-align: left;
    }

    .footer-section h4 {
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: var(--highlight);
    }

    .footer-section ul {
      list-style: none;
      padding: 0;
    }

    .footer-section ul li {
      margin-bottom: 8px;
    }

    .footer-section ul li a {
      color: var(--text);
      transition: color 0.2s ease;
    }

    .footer-section ul li a:hover {
      color: var(--highlight);
    }

    .footer-bottom {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid var(--card-border);
    }

    .footer-bottom p {
      margin-bottom: 10px;
    }

    .social-icons {
      margin-top: 15px;
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .social-icons a {
      color: var(--text);
      font-size: 1.5rem;
      transition: color 0.2s ease;
    }

    .social-icons a:hover {
      color: var(--highlight);
    }


    /* Responsive Design */
    @media (max-width: 768px) {
      /* Header Re-arrangement for small screens */
      .utility-header {
        flex-direction: column;
        text-align: center;
        padding-bottom: 10px;
      }

      .header-utility-actions {
        width: 100%;
        justify-content: center; /* Centers icons */
        margin-top: 10px;
      }

      /* Hide desktop navigation on small screens */
      .main-nav-header {
        display: none; 
        flex-direction: column;
        padding: 0;
      }

      /* Show mobile menu toggle icon on small screens */
      .mobile-menu-toggle {
        display: block; 
      }
      
      /* Mobile nav links, hidden by default, toggled by JS */
      .mobile-nav-links {
        display: none; 
        flex-direction: column;
        background-color: var(--header-bg);
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        padding: 10px 20px;
        border-bottom: 1px solid var(--card-border);
      }

      /* Class added by JS to show the mobile menu */
      .mobile-nav-links.show-mobile-menu { 
          display: flex;
      }

      .mobile-nav-links a {
        padding: 10px 0;
        text-align: center;
        border-bottom: 1px solid rgba(0,0,0,0.05); /* Light separator */
        color: var(--text);
      }

      .mobile-nav-links a:last-child {
        border-bottom: none;
      }

      .logo a {
        font-size: 1.5rem;
      }

      .footer-content {
        flex-direction: column;
        text-align: center;
      }

      .footer-section {
        flex: 1 1 100%;
        text-align: center;
      }

      .social-icons {
        justify-content: center;
      }

      .dynamic-search-area.show {
        max-height: 180px; /* Adjusts height for mobile filters */
      }

      .search-input-wrapper {
        flex-wrap: wrap; /* Allows icons to wrap if needed */
        justify-content: center;
      }

      .search-input-wrapper input[type="text"] {
        width: 100%; /* Full width input */
        max-width: none;
      }

      .search-filters {
        flex-direction: column; /* Stacks filters vertically */
        align-items: center;
      }

      .search-filters select,
      .search-filters input[type="text"] {
        width: 90%; /* Makes filters wider */
        max-width: 300px;
      }

      /* Responsive Hero Section */
      .hero-section {
          height: 400px;
      }
      .hero-content {
          margin-left: 0;
          text-align: center;
          padding: 15px;
          display: flex;
          flex-direction: column;
          align-items: center;
      }
      .hero-content h1 {
          font-size: 2.5rem;
          margin-bottom: 10px;
      }
      .hero-content p {
          font-size: 1rem;
          margin-bottom: 20px;
      }
      .hero-buttons {
          display: flex;
          flex-direction: column;
          gap: 10px;
      }
      .hero-buttons .btn {
          margin-right: 0;
          width: 200px; /* Constrain button width */
          justify-content: center;
      }
      .hero-quote-card {
          display: none; /* Hide on small screens for simplicity */
      }
      /* Carousel adjustments for smaller screens */
      .show-carousel {
          padding: 0 10px; /* Less space for arrows on small screens */
      }
      .carousel-arrow {
          font-size: 1.2rem;
          padding: 10px 5px;
      }
      .show-card {
        width: 150px; /* Smaller cards on mobile */
      }
      .show-card-poster {
        height: 225px; /* Adjust poster height for smaller cards */
      }
    }

    /* Explicitly hide mobile navigation on large screens to prevent accidental display */
    @media (min-width: 769px) {
        .mobile-nav-links {
            display: none !important; /* Use !important to override any other conflicting styles */
        }
    }

    @media (max-width: 480px) {
      /* No additional changes needed for header/footer specifically */
    }
  </style>
</head>
<body>
  <!-- Custom Alert/Message Box Structure -->
  <div id="customAlert" class="custom-alert">
    <div class="alert-content">
      <i id="alertIcon" class="alert-icon fas fa-info-circle blue-icon"></i>
      <p id="alertMessage">This is a custom alert message.</p>
      <button id="closeAlertBtn">OK</button>
    </div>
  </div>

  <header class="main-global-header">
    <!-- Utility Header: Logo, Search Toggle, Account, Dark Mode, Mobile Menu Toggle -->
    <div class="utility-header">
      <div class="logo">
        <a href="index.html">CineWatch</a>
      </div>
      <div class="header-utility-actions">
        <!-- Search Icon (toggles expanded search bar) -->
        <div class="search-bar-toggle">
          <button class="search-toggle-button" id="searchToggleButton" aria-label="Toggle Search">
            <i class="fas fa-search"></i>
          </button>
        </div>
        
        <!-- Account Menu -->
        <div class="account-menu">
          <button class="account-button" id="accountButton" aria-label="Account Menu">
            <i class="fas fa-user-circle"></i>
          </button>
          <div class="account-dropdown" id="accountDropdown">
            <a href="profile.html" id="desktopProfileLink" class="account-item"><i class="fas fa-user"></i> Profile</a>
            <a href="settings.html" id="desktopSettingsLink" class="account-item"><i class="fas fa-cog"></i> Settings</a>
            <a href="watchlist.html" id="desktopWatchlistLink" class="account-item"><i class="fas fa-bookmark"></i> Watchlist</a>
            <a href="history.html" id="desktopHistoryLink" class="account-item"><i class="fas fa-history"></i> History</a>
            <a href="login.html" id="desktopLoginLink" class="account-item"><i class="fas fa-sign-in-alt"></i> Login</a>
            <a href="register.html" id="desktopRegisterLink" class="account-item"><i class="fas fa-user-plus"></i> Register</a>
            <a href="#" id="desktopLogoutLink" class="account-item"><i class="fas fa-sign-out-alt"></i> Logout</a>
          </div>
        </div>
        
        <!-- Dark Mode Toggle -->
        <button class="theme-toggle-button" id="darkModeToggle" aria-label="Toggle Dark Mode" title="Toggle Dark Mode">
          <i class="fas fa-moon"></i>
        </button>
        
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle Mobile Menu">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>

    <!-- Main Navigation Header (Desktop Only) -->
    <nav class="main-nav-header" id="mainNavHeader">
      <a href="movies.html">Movies</a>
      <a href="tvshows.html">TV Shows</a>
      <a href="tv_networks.html">TV Networks</a> <!-- New TV Networks link -->
      <a href="cinema_guide.html">Cinema Guide</a>
      <a href="about_us.html">About Us</a>
    </nav>
  </header>

  <!-- Mobile Navigation Menu (Hidden by default, shown by JS toggle) -->
  <nav class="mobile-nav-links" id="mobileNavLinks">
    <a href="movies.html">Movies</a>
    <a href="tvshows.html">TV Shows</a>
    <a href="tv_networks.html">TV Networks</a> <!-- New TV Networks link -->
    <a href="cinema_guide.html">Cinema Guide</a>
    <a href="about_us.html">About Us</a>
    <!-- Account links for mobile -->
    <a href="profile.html" id="mobileProfileLink">Profile</a>
    <a href="settings.html" id="mobileSettingsLink">Settings</a>
    <a href="watchlist.html" id="mobileWatchlistLink">Watchlist</a>
    <a href="history.html" id="mobileHistoryLink">History</a>
    <a href="login.html" id="mobileLoginLink">Login</a>
    <a href="register.html" id="mobileRegisterLink">Register</a>
    <a href="#" id="mobileLogoutLink">Logout</a>
  </nav>

  <!-- Dynamic Search Input Area (Animated reveal) -->
  <section class="dynamic-search-area" id="dynamicSearchArea">
    <div class="search-input-wrapper">
      <input type="text" id="expandedSearchBar" placeholder="Search movies, shows, cast..." aria-label="Expanded Search Bar">
      <button class="search-icon-btn" id="micIconBtn" aria-label="Voice Search"><i class="fas fa-microphone"></i></button>
      <button class="search-icon-btn clear-search-btn" id="clearSearchBtn" aria-label="Clear Search"><i class="fas fa-times"></i></button>
      <button class="search-button-label" id="searchActionBtn">Search</button>
    </div>
    <!-- Search Suggestions Container -->
    <div class="search-suggestions-container" id="searchSuggestionsContainer">
      <!-- Suggestions will be populated here -->
    </div>
    <div class="search-filters">
      <select id="genreFilter" aria-label="Filter by Genre">
        <option value="">All Genres</option>
        <!-- Genres will be dynamically populated here by JS -->
      </select>
      <select id="yearFilter" aria-label="Filter by Release Year">
        <option value="">All Years</option>
        <!-- Years will be dynamically populated here by JS -->
      </select>
      <input type="text" id="castFilter" placeholder="Filter by Cast" aria-label="Filter by Cast">
    </div>
  </section>

  <main>
    <!-- Hero Section -->
    <section class="hero-section" id="heroSection">
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <h1 id="heroTitle">Loading Featured Content...</h1>
        <p id="heroSynopsis">Discover and enjoy a wide variety of movies, TV shows, and documentaries.</p>
        <div class="hero-buttons">
          <a href="#" class="btn" id="heroWatchNowBtn"><i class="fas fa-play"></i> Watch Now</a>
          <a href="#" class="btn" id="heroAddToWatchlistBtn"><i class="fas fa-plus"></i> Add to Watchlist</a>
        </div>
      </div>
      <div class="hero-quote-card">
        "The best stories are found here."
      </div>
    </section>

    <!-- Popular TV Shows Section -->
    <section class="content-section" id="popularTvSection">
      <h2>Popular TV Shows</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="popularTvContainer">
          <div class="spinner" id="spinnerPopularTv"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Popular%20TV%20Shows&endpoint=/tv/popular&mediaType=tv" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Trending Movies Section -->
    <section class="content-section" id="trendingMoviesSection">
      <h2>Trending Movies</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="trendingMoviesContainer">
          <div class="spinner" id="spinnerTrendingMovies"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Trending%20Movies&endpoint=/trending/movie/week&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- New Releases (TV Shows) Section -->
    <section class="content-section" id="newReleasesTvSection">
      <h2>New Releases (TV Shows)</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="newReleasesTvContainer">
          <div class="spinner" id="spinnerNewReleasesTv"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=New%20Releases%20(TV%20Shows)&endpoint=/tv/on_the_air&mediaType=tv" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Documentaries Section -->
    <section class="content-section" id="documentariesSection">
      <h2>Documentaries</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="documentariesContainer">
          <div class="spinner" id="spinnerDocumentaries"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Documentaries&endpoint=/discover/movie?with_genres=99&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Reality TV Shows Section -->
    <section class="content-section" id="realityTvSection">
      <h2>Reality TV Shows</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="realityTvContainer">
          <div class="spinner" id="spinnerRealityTv"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Reality%20TV%20Shows&endpoint=/discover/tv?with_genres=10764&mediaType=tv" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Talk Shows Section -->
    <section class="content-section" id="talkShowsSection">
      <h2>Talk Shows</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="talkShowsContainer">
          <div class="spinner" id="spinnerTalkShows"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Talk%20Shows&endpoint=/discover/tv?with_genres=10767&mediaType=tv" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Coming Soon Section -->
    <section class="content-section" id="comingSoonSection">
      <h2>Coming Soon (Movies)</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="comingSoonContainer">
          <div class="spinner" id="spinnerComingSoon"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Coming%20Soon%20(Movies)&endpoint=/movie/upcoming&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Season Finale Section (Top Rated TV Shows) -->
    <section class="content-section" id="seasonFinaleSection">
      <h2>Top Rated TV Shows</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="seasonFinaleContainer">
          <div class="spinner" id="spinnerSeasonFinale"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Top%20Rated%20TV%20Shows&endpoint=/tv/top_rated&mediaType=tv" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Kenyan Drama Section -->
    <section class="content-section" id="kenyanDramaSection">
      <h2>Kenyan Drama</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="kenyanDramaContainer">
          <div class="spinner" id="spinnerKenyanDrama"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Kenyan%20Drama&endpoint=/discover/tv?with_origin_country=KE&with_genres=18&mediaType=tv" class="load-more-btn">Load More Shows</a>
      </div>
    </section>
    
    <!-- K-Drama Section -->
    <section class="content-section" id="kDramaSection">
      <h2>K-Drama</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="kDramaContainer">
          <div class="spinner" id="spinnerKDrama"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=K-Drama&endpoint=/discover/tv?with_original_language=ko&mediaType=tv" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Hollywood Section -->
    <section class="content-section" id="hollywoodSection">
      <h2>Hollywood</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="hollywoodContainer">
          <div class="spinner" id="spinnerHollywood"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Hollywood&endpoint=/discover/movie?region=US&sort_by=popularity.desc&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Bollywood Section -->
    <section class="content-section" id="bollywoodSection">
      <h2>Bollywood</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="bollywoodContainer">
          <div class="spinner" id="spinnerBollywood"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Bollywood&endpoint=/discover/movie?with_original_language=hi&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Chinese Section -->
    <section class="content-section" id="chineseSection">
      <h2>Chinese</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="chineseContainer">
          <div class="spinner" id="spinnerChinese"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Chinese&endpoint=/discover/movie?with_original_language=zh&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Swahili Section -->
    <section class="content-section" id="swahiliSection">
      <h2>Swahili Shows</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="swahiliContainer">
          <div class="spinner" id="spinnerSwahili"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Swahili%20Shows&endpoint=/discover/tv?with_original_language=sw%7Cwith_origin_country=KE&mediaType=tv" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- International Hits Section -->
    <section class="content-section" id="internationalHitsSection">
      <h2>International Hits</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="internationalHitsContainer">
          <div class="spinner" id="spinnerInternationalHits"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=International%20Hits&endpoint=/discover/movie?without_original_language=en,hi,ko&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Best Of Warners Bros Section -->
    <section class="content-section" id="warnersBrosSection">
      <h2>Best Of Warner Bros</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="warnersBrosContainer">
          <div class="spinner" id="spinnerWarnersBros"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Best%20Of%20Warner%20Bros&endpoint=/discover/movie?with_companies=174&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>

    <!-- Best Of Tyler Perry Section -->
    <section class="content-section" id="tylerPerrySection">
      <h2>Best Of Tyler Perry</h2>
      <div class="show-carousel">
        <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
        <div class="show-carousel-inner" id="tylerPerryContainer">
          <div class="spinner" id="spinnerTylerPerry"></div>
        </div>
        <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="load-more-btn-wrapper">
        <a href="category_details.html?categoryName=Best%20Of%20Tyler%20Perry&endpoint=/discover/movie?with_crew=18928&mediaType=movie" class="load-more-btn">Load More Shows</a>
      </div>
    </section>
  </main>

  <footer class="main-footer">
    <div class="footer-content">
      <div class="footer-section">
        <h4>About CineWatch</h4>
        <ul>
          <li><a href="about_us.html">Our Story</a></li>
          <li><a href="contact.html">Contact Us</a></li>
          <li><a href="careers.html">Careers</a></li>
          <li><a href="investors.html">Investors</a></li>
          <li><a href="about_developer.html">About Developer</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Help & Support</h4>
        <ul>
          <li><a href="support.html">FAQ</a></li>
          <li><a href="terms_of_service.html">Terms of Service</a></li>
          <li><a href="privacy_policy.html">Privacy Policy</a></li>
          <li><a href="sitemap.xml">Sitemap</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Explore</h4>
        <ul>
          <li><a href="movies.html">Movies</a></li>
          <li><a href="tvshows.html">TV Shows</a></li>
          <li><a href="categories.html">Genres</a></li>
          <li><a href="new_releases.html">New Releases</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Connect with Us</h4>
        <p>Stay updated on our latest releases and news.</p>
        <div class="social-icons">
          <a href="https://www.facebook.com/aslekiymastamynd" target="_blank" rel="noopener noreferrer" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="https://x.com/yourhandle" target="_blank" rel="noopener noreferrer" aria-label="X (formerly Twitter)"><i class="fab fa-twitter"></i></a>
          <a href="https://www.instagram.com/yourprofile" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="https://www.linkedin.com/in/alexmalunda" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; <span id="current-year"></span> CineWatch. All rights reserved.</p>
      <p>Last Modified: <span id="last-modified"></span></p>
    </div>
  </footer>

  <script>
    // Global state for user login (simulated)
    let userLoggedIn = false;

    // TMDB API Configuration (only used for genre/year filter population, not content)
    const TMDB_API_KEY = '9c198aabc1df9fa96ea8d65e183cb8a3'; 
    const TMDB_BASE_URL = 'https://api.themoviedb.org/3'; 
    const TMDB_IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/';
    const POSTER_SIZE = 'w342'; // For show cards
    const BACKDROP_SIZE = 'w1280'; // For hero section
    const PROFILE_SIZE = 'w185'; // For cast images

    // Transparent GIF for image fallback (avoids external placeholder services)
    const IMAGE_NOT_FOUND_URL = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';

    // TMDB IDs for specific categories/entities
    const TMDB_GENRE_ID_DRAMA_TV = 18; // Common Drama genre ID for TV
    const TMDB_GENRE_ID_REALITY_TV = 10764; // Common Reality TV genre ID
    const TMDB_GENRE_ID_DOCUMENTARY_MOVIE = 99; // Documentary genre ID for movies
    const TMDB_GENRE_ID_TALK_SHOW = 10767; // TMDB Genre ID for Talk Show
    const TMDB_COMPANY_ID_WARNER_BROS = 174; // Warner Bros. Entertainment
    const TMDB_COMPANY_ID_TYLER_PERRY_STUDIOS = 105804; // Tyler Perry Studios ID
    const TMDB_PERSON_ID_TYLER_PERRY = 18928; // Tyler Perry Person ID (for creator/director)
    const TMDB_PERSON_ID_TONY_JAA = 120530; // Tony Jaa Person ID
    const TMDB_PERSON_ID_IKO_UWAIS = 1085028; // Iko Uwais Person ID
    const TMDB_PERSON_ID_SARAH_HASSAN = 1595171; // Sarah Hassan Person ID
    const TMDB_PERSON_ID_JACKIE_CHAN = 18897; // Jackie Chan Person ID
    const TMDB_PERSON_ID_DONNIE_YEN = 1341; // Donnie Yen Person ID
    const TMDB_PERSON_ID_JET_LI = 1336; // Jet Li Person ID
    const TMDB_PERSON_ID_SALMAN_KHAN = 62562; // Salman Khan Person ID
    const TMDB_NETWORK_ID_MBC_BOLLYWOOD = 3208; // MBC Bollywood Network ID
    const TMDB_PERSON_ID_ALBA_CARRILLO = 2048013; // Alba Carrillo Person ID
    const TMDB_PERSON_ID_GONG_YOO = 150903; // Gong Yoo Person ID
    const TMDB_PERSON_ID_LEE_JUNG_JAE = 73249; // Lee Jung-jae Person ID


    /**
     * Displays a custom alert/message box to the user.
     * @param {string} message - The message to display.
     * @param {string} iconClasses - Font Awesome classes for the icon.
     */
    function showMessageBox(message, iconClasses = "fas fa-info-circle blue-icon") {
        const customAlert = document.getElementById('customAlert');
        const alertMessage = document.getElementById('alertMessage');
        const alertIcon = customAlert.querySelector('.alert-icon');
        const closeAlertBtn = document.getElementById('closeAlertBtn');

        if (customAlert && alertMessage && alertIcon && closeAlertBtn) {
            alertMessage.textContent = message;
            alertIcon.className = 'alert-icon ' + iconClasses;
            customAlert.classList.add('show');

            const closeHandler = () => {
                customAlert.classList.remove('show');
                closeAlertBtn.removeEventListener('click', closeHandler);
            };
            closeAlertBtn.addEventListener('click', closeHandler);

            const overlayClickHandler = (event) => {
                if (event.target === customAlert) {
                    customAlert.classList.remove('show');
                    customAlert.removeEventListener('click', overlayClickHandler);
                }
            };
            customAlert.addEventListener('click', overlayClickHandler);
        } else {
            console.error("MessageBox elements not found. Cannot show message.");
        }
    }

    /**
     * Scrolls the carousel horizontally.
     * @param {HTMLElement} container - The carousel inner container element.
     * @param {string} direction - 'left' or 'right'.
     */
    function scrollCarousel(container, direction) {
        // Adjust scroll amount based on card width and gap
        const firstCard = container.querySelector('.show-card');
        if (!firstCard) return;

        const cardWidth = firstCard.offsetWidth;
        const gap = parseFloat(getComputedStyle(container).gap); // Get dynamic gap
        const scrollAmount = cardWidth + gap; 

        if (direction === 'left') {
            container.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
        } else {
            container.scrollBy({ left: scrollAmount, behavior: 'smooth' });
        }
    }


    /**
     * Fetches genres from TMDB for a specific type (movie or tv).
     * @param {string} type - 'movie' or 'tv'.
     * @returns {Promise<Array>} An array of genre objects.
     */
    async function fetchGenres(type) {
        const url = `${TMDB_BASE_URL}/genre/${type}/list?api_key=${TMDB_API_KEY}&language=en-US`;
        try {
            const response = await fetch(url);
            if (!response.ok) {
                console.warn(`Could not fetch ${type} genres. Status: ${response.status}.`);
                return []; 
            }
            const data = await response.json();
            return data.genres;
        } catch (error) {
            console.warn(`Error fetching ${type} genres:`, error);
            return [];
        }
    }

    /**
     * Populates a select element with genre options.
     * @param {HTMLElement} selectElement - The select element to populate.
     * @param {Array} genres - Array of genre objects.
     */
    function populateGenreFilter(selectElement, genres) {
        if (!selectElement) return;
        genres.forEach(genre => {
            const option = document.createElement('option');
            option.value = genre.id;
            option.textContent = genre.name;
            selectElement.appendChild(option);
        });
    }

    /**
     * Populates a select element with year options.
     * @param {HTMLElement} selectElement - The select element to populate.
     * @param {number} startYear - The starting year.
     * @param {number} endYear - The ending year.
     */
    function populateYearFilter(selectElement, startYear, endYear) {
        if (!selectElement) return;
        for (let year = endYear; year >= startYear; year--) {
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            selectElement.appendChild(option);
        }
    }

    /**
     * Toggles dark mode on/off.
     */
    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        const darkModeToggle = document.getElementById('darkModeToggle');
        if (darkModeToggle) {
            if (document.body.classList.contains('dark-mode')) {
                darkModeToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun'); // Update icon
                darkModeToggle.setAttribute('aria-label', 'Toggle Light Mode'); // Update aria-label
                darkModeToggle.setAttribute('title', 'Toggle Light Mode'); // Update title
                localStorage.setItem('theme', 'dark'); // Saves preference
            } else {
                darkModeToggle.querySelector('i').classList.replace('fa-sun', 'fa-moon'); // Update icon
                darkModeToggle.setAttribute('aria-label', 'Toggle Dark Mode'); // Update aria-label
                darkModeToggle.setAttribute('title', 'Toggle Dark Mode'); // Update title
                localStorage.setItem('theme', 'light'); // Saves preference
            }
        }
    }

    /**
     * Updates the visibility of login/logout/profile links in the account dropdown and mobile menu.
     * @param {boolean} isLoggedIn - True if the user is logged in, false otherwise.
     */
    function updateAccountDropdown(isLoggedIn) {
        // Desktop links
        const desktopLoginLink = document.getElementById('desktopLoginLink');
        const desktopRegisterLink = document.getElementById('desktopRegisterLink');
        const desktopProfileLink = document.getElementById('desktopProfileLink');
        const desktopSettingsLink = document.getElementById('desktopSettingsLink');
        const desktopWatchlistLink = document.getElementById('desktopWatchlistLink');
        const desktopHistoryLink = document.getElementById('desktopHistoryLink');
        const desktopLogoutLink = document.getElementById('desktopLogoutLink');
        
        // Mobile links
        const mobileProfileLink = document.getElementById('mobileProfileLink');
        const mobileSettingsLink = document.getElementById('mobileSettingsLink');
        const mobileWatchlistLink = document.getElementById('mobileWatchlistLink');
        const mobileHistoryLink = document.getElementById('mobileHistoryLink');
        const mobileLoginLink = document.getElementById('mobileLoginLink');
        const mobileRegisterLink = document.getElementById('mobileRegisterLink');
        const mobileLogoutLink = document.getElementById('mobileLogoutLink');

        const elementsToToggle = [
            { desktop: desktopLoginLink, mobile: mobileLoginLink, display: !isLoggedIn },
            { desktop: desktopRegisterLink, mobile: mobileRegisterLink, display: !isLoggedIn },
            { desktop: desktopProfileLink, mobile: mobileProfileLink, display: isLoggedIn },
            { desktop: desktopSettingsLink, mobile: mobileSettingsLink, display: isLoggedIn },
            { desktop: desktopWatchlistLink, mobile: mobileWatchlistLink, display: isLoggedIn },
            { desktop: desktopHistoryLink, mobile: mobileHistoryLink, display: isLoggedIn },
            { desktop: desktopLogoutLink, mobile: mobileLogoutLink, display: isLoggedIn }
        ];

        elementsToToggle.forEach(item => {
            if (item.desktop) item.desktop.style.display = item.display ? 'flex' : 'none';
            if (item.mobile) item.mobile.style.display = item.display ? 'flex' : 'none';
        });
        userLoggedIn = isLoggedIn; // Updates global state
    }

    /**
     * Fetches a single popular movie or TV show to be featured in the hero section.
     * @returns {Promise<Object|null>} A show object or null if fetching fails.
     */
    async function fetchFeaturedContent() {
        try {
            const response = await fetch(`${TMDB_BASE_URL}/trending/all/week?api_key=${TMDB_API_KEY}&language=en-US`);
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            const data = await response.json();
            return data.results && data.results.length > 0 ? data.results[0] : null;
        } catch (error) {
            console.error("Could not fetch featured content:", error);
            return null;
        }
    }

    /**
     * Populates the hero section with featured content.
     * @param {Object} content - The show/movie object from TMDB.
     */
    function populateHeroSection(content) {
        const heroSection = document.getElementById('heroSection');
        const heroTitle = document.getElementById('heroTitle');
        const heroSynopsis = document.getElementById('heroSynopsis');

        if (content && heroSection && heroTitle && heroSynopsis) {
            const title = content.title || content.name || 'Featured Content';
            const synopsis = content.overview || 'Discover and enjoy a wide variety of movies, TV shows, and documentaries.';
            const backdropPath = content.backdrop_path ? `${TMDB_IMAGE_BASE_URL}${BACKDROP_SIZE}${content.backdrop_path}` : '';

            heroTitle.textContent = title;
            heroSynopsis.textContent = synopsis;
            if (backdropPath) {
                heroSection.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('${backdropPath}')`;
            } else {
                // Fallback for missing backdrop
                heroSection.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://placehold.co/1280x720/282828/f0f0f0?text=No+Image+Available')`;
            }
        }
    }

    /**
     * Creates a single show card HTML element.
     * @param {Object} show - The show/movie object from TMDB.
     * @returns {HTMLElement} The created show card div.
     */
    function createShowCard(show) {
        const card = document.createElement('div');
        card.classList.add('show-card');

        // Determine poster path, using transparent GIF if not available
        const posterPath = show.poster_path ? `${TMDB_IMAGE_BASE_URL}${POSTER_SIZE}${show.poster_path}` : IMAGE_NOT_FOUND_URL;
        const title = show.title || show.name;
        const releaseDate = show.release_date || show.first_air_date;
        const year = releaseDate ? new Date(releaseDate).getFullYear() : 'N/A';
        const rating = show.vote_average ? show.vote_average.toFixed(1) : 'N/A';
        const mediaType = show.media_type || (show.title ? 'movie' : 'tv'); // Infer type if not present

        // Add 'no-image' class if poster is missing for CSS fallback
        if (!show.poster_path) {
            card.classList.add('no-image');
        }

        // The entire card becomes a link to the details page
        card.innerHTML = `
            <a href="details.html?id=${show.id}&type=${mediaType}">
                <img src="${posterPath}" alt="${title} Poster" class="show-card-poster" 
                     onerror="this.onerror=null; this.src='https://placehold.co/342x270/282828/f0f0f0?text=No+Image'; this.closest('.show-card').classList.add('no-image');">
                <div class="show-card-rating">${rating}</div>
                <div class="show-card-content">
                    <h3 class="show-card-title">${title}</h3>
                    <p class="show-card-meta">
                        <span>${year}</span>
                        <span><i class="fas fa-star"></i> ${rating}</span>
                    </p>
                    <div class="show-card-buttons">
                        <span class="btn-details">Details</span>
                    </div>
                </div>
            </a>
        `;
        return card;
    }

    /**
     * Fetches a list of shows (movies or TV) and populates a carousel container.
     * It attempts to fetch up to `requiredCount` by iterating through pages.
     * Only displays `displayLimit` shows in the carousel initially.
     * @param {string} endpoint - The TMDB API endpoint (e.g., '/tv/popular', '/movie/now_playing').
     * @param {HTMLElement} containerElement - The DOM element to append show cards to (the .show-carousel-inner).
     * @param {string} mediaType - Explicit media type ('movie' or 'tv') if known for the endpoint.
     * @param {number} [requiredCount=20] - The target number of items to fetch in total.
     * @param {number} [displayLimit=10] - The number of items to display in the carousel initially.
     */
    async function fetchAndPopulateShows(endpoint, containerElement, mediaType, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block'; // Show spinner

        let allResults = [];
        let page = 1;
        const maxPagesToFetch = Math.ceil(requiredCount / 20) + 1; // Fetch enough pages to get requiredCount (TMDB returns max 20 per page)
        const fetchedIds = new Set(); // To prevent duplicates

        try {
            while (allResults.length < requiredCount && page <= maxPagesToFetch) {
                const url = `${TMDB_BASE_URL}${endpoint}?api_key=${TMDB_API_KEY}&language=en-US&page=${page}`;
                const response = await fetch(url);
                if (!response.ok) {
                    console.warn(`Could not fetch data for ${endpoint}, page ${page}. Status: ${response.status}.`);
                    break; // Exit loop on error
                }
                const data = await response.json();
                if (data.results && data.results.length > 0) {
                    data.results.forEach(item => {
                        if (!fetchedIds.has(item.id)) {
                            allResults.push({ ...item, media_type: item.media_type || mediaType });
                            fetchedIds.add(item.id);
                        }
                    });
                    page++;
                } else {
                    break; // No more results
                }
            }

            // Clear existing placeholders/spinners if any
            containerElement.innerHTML = ''; 

            if (allResults.length > 0) {
                // Only display up to `displayLimit` in the carousel
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No content available for this section.</p>`;
            }
        } catch (error) {
            console.error(`Error fetching data for ${endpoint}:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load content for this section.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none'; // Hide spinner
        }
    }

    /**
     * Fetches search results from TMDB's multi-search endpoint.
     * @param {string} query - The search query.
     * @returns {Promise<Array>} An array of search results (movies, TV shows, people).
     */
    async function fetchSearchResults(query) {
        if (!query) return [];
        try {
            const url = `${TMDB_BASE_URL}/search/multi?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(query)}`;
            const response = await fetch(url);
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            const data = await response.json();
            // Filter out results without a title/name, and media_type not useful for direct display (e.g., 'collection')
            return data.results.filter(item => 
                (item.media_type === 'movie' || item.media_type === 'tv' || item.media_type === 'person') && 
                (item.title || item.name)
            );
        } catch (error) {
            console.error("Error fetching search results:", error);
            return [];
        }
    }

    /**
     * Displays search results as suggestions in the search suggestions container.
     * @param {Array} results - An array of search result objects (movies, TV shows, people).
     */
    function displaySearchResults(results) {
        const searchSuggestionsContainer = document.getElementById('searchSuggestionsContainer');
        if (!searchSuggestionsContainer) return;

        searchSuggestionsContainer.innerHTML = ''; // Clear previous suggestions

        if (results.length > 0) {
            results.slice(0, 5).forEach(item => { // Display top 5 suggestions
                const suggestionItem = document.createElement('div');
                suggestionItem.classList.add('search-suggestion-item');

                const imagePath = item.poster_path ? `${TMDB_IMAGE_BASE_URL}w92${item.poster_path}` : 
                                  (item.profile_path ? `${TMDB_IMAGE_BASE_URL}w92${item.profile_path}` : 
                                   'https://placehold.co/92x138/cccccc/555555?text=No+Image'); // Fallback for profile/poster
                
                const title = item.title || item.name;
                let subtitle = '';
                if (item.media_type === 'movie') {
                    subtitle = item.release_date ? `Movie (${new Date(item.release_date).getFullYear()})` : 'Movie';
                } else if (item.media_type === 'tv') {
                    subtitle = item.first_air_date ? `TV Show (${new Date(item.first_air_date).getFullYear()})` : 'TV Show';
                } else if (item.media_type === 'person') {
                    subtitle = item.known_for_department || 'Person';
                }

                suggestionItem.innerHTML = `
                    <img src="${imagePath}" alt="${title}" onerror="this.onerror=null; this.src='https://placehold.co/92x138/cccccc/555555?text=No+Image';">
                    <div class="search-suggestion-info">
                        <h4>${title}</h4>
                        <p>${subtitle}</p>
                    </div>
                `;
                searchSuggestionsContainer.appendChild(suggestionItem);

                // Add click listener to fill search bar and potentially navigate
                suggestionItem.addEventListener('click', () => {
                    document.getElementById('expandedSearchBar').value = title;
                    searchSuggestionsContainer.classList.remove('show');
                    // Optionally, navigate to details page immediately
                    if (item.media_type === 'movie' || item.media_type === 'tv') {
                        window.location.href = `details.html?id=${item.id}&type=${item.media_type}`;
                    } else if (item.media_type === 'person') {
                        showMessageBox(`Clicked on person: ${item.name}. (Navigation to person details not yet implemented)`, 'fas fa-info-circle blue-icon');
                    }
                });
            });
            searchSuggestionsContainer.classList.add('show'); // Show the container
        } else {
            searchSuggestionsContainer.classList.remove('show'); // Hide if no results
        }
    }


    /**
     * Fetches an actor's filmography.
     * @param {number} personId - The TMDB ID of the person.
     * @param {string} [mediaType='all'] - 'movie', 'tv', or 'all'.
     * @returns {Promise<Array>} An array of movie/TV show objects.
     */
    async function fetchActorFilmography(personId, mediaType = 'all') {
        let allCredits = [];
        try {
            const movieCreditsUrl = `${TMDB_BASE_URL}/person/${personId}/movie_credits?api_key=${TMDB_API_KEY}&language=en-US`;
            const tvCreditsUrl = `${TMDB_BASE_URL}/person/${personId}/tv_credits?api_key=${TMDB_API_KEY}&language=en-US`;

            if (mediaType === 'movie' || mediaType === 'all') {
                const movieResponse = await fetch(movieCreditsUrl);
                if (movieResponse.ok) {
                    const data = await movieResponse.json();
                    allCredits = allCredits.concat(data.cast.map(item => ({...item, media_type: 'movie'})));
                } else {
                    console.warn(`Could not fetch movie credits for person ${personId}. Status: ${movieResponse.status}.`);
                }
            }

            if (mediaType === 'tv' || mediaType === 'all') {
                const tvResponse = await fetch(tvCreditsUrl);
                if (tvResponse.ok) {
                    const data = await tvResponse.json();
                    allCredits = allCredits.concat(data.cast.map(item => ({...item, media_type: 'tv'})));
                } else {
                    console.warn(`Could not fetch TV credits for person ${personId}. Status: ${tvResponse.status}.`);
                }
            }
            return allCredits;
        } catch (error) {
            console.error(`Error fetching filmography for person ${personId}:`, error);
            return [];
        }
    }


    /**
     * Debounce function to limit how often a function is called.
     * @param {Function} func - The function to debounce.
     * @param {number} delay - The delay in milliseconds.
     * @returns {Function} The debounced function.
     */
    function debounce(func, delay) {
        let timeout;
        return function(...args) {
            const context = this;
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(context, args), delay);
        };
    }

    /**
     * Fetches and combines TV shows that are either in Swahili or from Kenya,
     * including content featuring Sarah Hassan and specific Kenyan titles.
     * @param {HTMLElement} containerElement - The DOM element to append show cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch in total.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchSwahiliAndKenyanShows(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set(); // To store IDs of already fetched shows for deduplication

        try {
            // 1. Fetch Swahili language TV shows
            let swahiliUrl = `${TMDB_BASE_URL}/discover/tv?api_key=${TMDB_API_KEY}&language=en-US&with_original_language=sw&sort_by=popularity.desc`;
            let swahiliResponse = await fetch(swahiliUrl);
            if (swahiliResponse.ok) {
                let data = await swahiliResponse.json();
                data.results.forEach(show => {
                    if (!fetchedIds.has(show.id)) {
                        allResults.push({ ...show, media_type: 'tv' });
                        fetchedIds.add(show.id);
                    }
                });
            } else {
                console.warn(`Could not fetch Swahili shows. Status: ${swahiliResponse.status}.`);
            }

            // 2. Fetch TV shows from Kenya (main endpoint for Kenyan Drama)
            let kenyanTvUrl = `${TMDB_BASE_URL}/discover/tv?api_key=${TMDB_API_KEY}&language=en-US&with_origin_country=KE&sort_by=popularity.desc`;
            let kenyanTvResponse = await fetch(kenyanTvUrl);
            if (kenyanTvResponse.ok) {
                let data = await kenyanTvResponse.json();
                data.results.forEach(show => {
                    if (!fetchedIds.has(show.id)) {
                        allResults.push({ ...show, media_type: 'tv' });
                        fetchedIds.add(show.id);
                    }
                });
            } else {
                console.warn(`Could not fetch Kenyan TV shows. Status: ${kenyanTvResponse.status}.`);
            }

            // 3. Fetch movies from Kenya (for completeness)
            let kenyanMovieUrl = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&with_origin_country=KE&sort_by=popularity.desc`;
            let kenyanMovieResponse = await fetch(kenyanMovieUrl);
            if (kenyanMovieResponse.ok) {
                let data = await kenyanMovieResponse.json();
                data.results.forEach(movie => {
                    if (!fetchedIds.has(movie.id)) {
                        allResults.push({ ...movie, media_type: 'movie' });
                        fetchedIds.add(movie.id);
                    }
                });
            } else {
                console.warn(`Could not fetch Kenyan movies. Status: ${kenyanMovieResponse.status}.`);
            }

            // 4. Fetch content by Sarah Hassan
            if (TMDB_PERSON_ID_SARAH_HASSAN) {
                const sarahHassanCredits = await fetchActorFilmography(TMDB_PERSON_ID_SARAH_HASSAN, 'all');
                sarahHassanCredits.forEach(item => {
                    // Only add if it's Kenyan or explicitly mentioned, to avoid non-Kenyan international projects
                    if (!fetchedIds.has(item.id) && (item.origin_country?.includes('KE') || item.production_countries?.some(pc => pc.iso_3166_1 === 'KE') || ['Crime and Justice', 'Family vacation', 'Just in Time', 'Plan B'].includes(item.title || item.name))) {
                        allResults.push(item);
                        fetchedIds.add(item.id);
                    }
                });
            }
            
            // 5. Search for specific Kenyan movie titles provided
            const specificKenyanTitles = [
                'Rise and Fall of Idi Amin', 'In the Shadow of Kilimanjaro',
                'Men Against the Sun', 'Christmas Love'
            ];
            for (const title of specificKenyanTitles) {
                const searchUrl = `${TMDB_BASE_URL}/search/movie?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(title)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0];
                        if (!fetchedIds.has(topResult.id) && (topResult.original_language === 'en' || topResult.origin_country?.includes('KE'))) { // Check for English language or Kenyan origin as a proxy
                            allResults.push({ ...topResult, media_type: 'movie' });
                            fetchedIds.add(topResult.id);
                        }
                    }
                }
            }


            // Clear existing content
            containerElement.innerHTML = '';

            if (allResults.length > 0) {
                // Sort by popularity and then slice for display
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No Swahili or Kenyan content found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Swahili/Kenyan data:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Swahili/Kenyan content.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }


    /**
     * Fetches popular international movies and specific international TV show examples.
     * @param {HTMLElement} containerElement - The DOM element to append show cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchInternationalHits(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        try {
            // 1. Fetch popular movies not in English, Hindi, or Korean
            const discoverUrl = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&sort_by=popularity.desc&without_original_language=en,hi,ko&page=1`;
            const discoverResponse = await fetch(discoverUrl);
            if (discoverResponse.ok) {
                const data = await discoverResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'movie' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch general international movies. Status: ${discoverResponse.status}`);
            }

            // 2. Fetch specific TV shows by ID (Lupin, Money Heist)
            const specificTvIds = ['95207', '71446']; // Lupin, Money Heist
            for (const id of specificTvIds) {
                const tvUrl = `${TMDB_BASE_URL}/tv/${id}?api_key=${TMDB_API_KEY}&language=en-US`;
                const tvResponse = await fetch(tvUrl);
                if (tvResponse.ok) {
                    const tvData = await tvResponse.json();
                    if (!fetchedIds.has(tvData.id)) {
                        allResults.push({ ...tvData, media_type: 'tv' });
                        fetchedIds.add(tvData.id);
                    }
                } else {
                    console.warn(`Could not fetch TV show with ID ${id}. Status: ${tvResponse.status}`);
                }
            }

            // 3. Fetch specific movies by search (The Raid, Ong Bak, The Day of the Jackal)
            const specificMovieQueries = ['The Raid', 'Ong Bak', 'The Day of the Jackal'];
            for (const query of specificMovieQueries) {
                const searchUrl = `${TMDB_BASE_URL}/search/movie?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(query)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0]; // Take the most relevant result
                        if (!fetchedIds.has(topResult.id)) {
                            allResults.push({ ...topResult, media_type: 'movie' });
                            fetchedIds.add(topResult.id);
                        }
                    }
                } else {
                    console.warn(`Could not search for movie "${query}". Status: ${searchResponse.status}`);
                }
            }

            // 4. Fetch movies by specific international actors (Tony Jaa, Iko Uwais)
            const internationalActors = [TMDB_PERSON_ID_TONY_JAA, TMDB_PERSON_ID_IKO_UWAIS];
            for (const personId of internationalActors) {
                const moviesByActor = await fetchActorFilmography(personId, 'movie');
                moviesByActor.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push(item);
                        fetchedIds.add(item.id);
                    }
                });
            }


            // Clear existing content
            containerElement.innerHTML = '';

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No International Hits found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching International Hits:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load International Hits.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }


    /**
     * Fetches popular talk shows using a combination of genre and specific searches.
     * @param {HTMLElement} containerElement - The DOM element to append show cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchTalkShows(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        try {
            // 1. Fetch TV shows directly categorized as 'Talk Show' (TMDB genre ID 10767)
            const talkShowGenreUrl = `${TMDB_BASE_URL}/discover/tv?api_key=${TMDB_API_KEY}&language=en-US&with_genres=${TMDB_GENRE_ID_TALK_SHOW}&sort_by=popularity.desc&page=1`;
            const talkShowGenreResponse = await fetch(talkShowGenreUrl);
            if (talkShowGenreResponse.ok) {
                const data = await talkShowGenreResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'tv' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch talk shows by genre. Status: ${talkShowGenreResponse.status}`);
            }

            // 2. Search for specific popular talk shows by name
            const specificTalkShowQueries = [
                'The Daily Show',
                'The Late Late Show with James Corden',
                'The Tonight Show Starring Jimmy Fallon',
                'Steve' // For "The Steve Harvey Show" or "Steve" (talk show)
            ];

            for (const query of specificTalkShowQueries) {
                const searchUrl = `${TMDB_BASE_URL}/search/tv?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(query)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0]; // Take the most relevant result
                        // Double check if it's actually a talk show by checking genres if possible, or trust primary result
                        if (!fetchedIds.has(topResult.id) && topResult.genre_ids && topResult.genre_ids.includes(TMDB_GENRE_ID_TALK_SHOW)) {
                            allResults.push({ ...topResult, media_type: 'tv' });
                            fetchedIds.add(topResult.id);
                        } else if (!fetchedIds.has(topResult.id) && (query === 'Steve' && topResult.name === 'Steve')) { // Specific check for "Steve" talk show
                             allResults.push({ ...topResult, media_type: 'tv' });
                             fetchedIds.add(topResult.id);
                        }
                    }
                } else {
                    console.warn(`Could not search for TV show "${query}". Status: ${searchResponse.status}`);
                }
            }


            // Clear existing content
            containerElement.innerHTML = '';

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No Talk Shows found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Talk Shows:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Talk Shows.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }


    /**
     * Fetches movies from Tyler Perry Studios.
     * @param {HTMLElement} containerElement - The DOM element to append movie cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchTylerPerryStudiosMovies(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        try {
            // Option 1: Discover movies by Tyler Perry Studios (company ID)
            const companyUrl = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&with_companies=${TMDB_COMPANY_ID_TYLER_PERRY_STUDIOS}&sort_by=popularity.desc`;
            const companyResponse = await fetch(companyUrl);
            if (companyResponse.ok) {
                const data = await companyResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'movie' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch movies by Tyler Perry Studios. Status: ${companyResponse.status}`);
            }

            // Option 2: Discover movies where Tyler Perry is part of the crew (director, writer etc.)
            // Note: This often overlaps with studio productions but ensures broader coverage.
            const crewUrl = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&with_crew=${TMDB_PERSON_ID_TYLER_PERRY}&sort_by=popularity.desc`;
            const crewResponse = await fetch(crewUrl);
            if (crewResponse.ok) {
                const data = await crewResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'movie' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch movies by Tyler Perry as crew. Status: ${crewResponse.status}`);
            }

            // Option 3: Search for specific Tyler Perry titles provided by the user, if not covered
            const specificTylerPerryTitles = [
                'STRAW', 'Tyler Perry\'s Duplicity', 'Acrimony', 'The Six Triple Eight',
                'Tyler Perry\'s Divorce in the Black', 'Diary of a Mad Black Woman',
                'Daddy\'s Little Girls', 'A Fall from Grace', 'Madea\'s Destination Wedding',
                'A Madea Family Funeral', 'Madea\'s Family Reunion', 'Madea Goes to Jail',
                'Tyler Perry\'s A Madea Homecoming', 'Tyler Perry\'s The Family That Preys',
                'Nobody\'s Fool', 'Temptation: Confessions of a Marriage Counselor',
                'Mea Culpa', 'Tyler Perry\'s Madea\'s Family Reunion - The Play',
                'The Single Moms Club', 'Boo! A Madea Halloween'
            ];

            for (const title of specificTylerPerryTitles) {
                const searchUrl = `${TMDB_BASE_URL}/search/movie?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(title)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0];
                        if (!fetchedIds.has(topResult.id)) {
                            allResults.push({ ...topResult, media_type: 'movie' });
                            fetchedIds.add(topResult.id);
                        }
                    }
                }
            }


            // Clear existing content
            containerElement.innerHTML = '';

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No content found for Best Of Tyler Perry.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Tyler Perry content:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Best Of Tyler Perry content.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }


    /**
     * Fetches movies from Warner Bros.
     * @param {HTMLElement} containerElement - The DOM element to append movie cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchWarnerBrosMovies(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        try {
            const url = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&with_companies=${TMDB_COMPANY_ID_WARNER_BROS}&sort_by=popularity.desc&page=1`;
            const response = await fetch(url);
            if (!response.ok) {
                console.warn(`Could not fetch Warner Bros movies. Status: ${response.status}.`);
            } else {
                const data = await response.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'movie' });
                        fetchedIds.add(item.id);
                    }
                });
            }

            // Also search for specific titles provided by the user that might not be directly linked to company discover
            const specificWarnerBrosTitles = [
                "Sinners", "A Minecraft Movie", "The Accountant", "Harry Potter and the Philosopher's Stone",
                "The Flash", "Mickey 17", "Harry Potter and the Chamber of Secrets", "Harry Potter and the Goblet of Fire",
                "Barbie", "Harry Potter and the Prisoner of Azkaban", "Inception", "Ready Player One",
                "The Batman", "The Matrix", "The Hangover", "Harry Potter and the Order of the Phoenix",
                "The Dark Knight", "Harry Potter and the Half-Blood Prince", "Harry Potter and the Deathly Hallows: Part 2",
                "Harry Potter and the Deathly Hallows: Part 1", "Yusuf & Yusuf", "Turks in Space", "Osman Pazarlama",
                "He's in the Army Now"
            ];

            for (const title of specificWarnerBrosTitles) {
                const searchUrl = `${TMDB_BASE_URL}/search/multi?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(title)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0]; // Take the most relevant result
                        if (!fetchedIds.has(topResult.id) && (topResult.media_type === 'movie' || topResult.media_type === 'tv')) {
                            allResults.push({ ...topResult, media_type: topResult.media_type });
                            fetchedIds.add(topResult.id);
                        }
                    }
                }
            }


            containerElement.innerHTML = ''; // Clear existing content

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No content found for Warner Bros.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Warner Bros movies:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Warner Bros. content.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }

    /**
     * Fetches and populates the Documentaries section with general documentaries
     * and specific titles provided by the user.
     * @param {HTMLElement} containerElement - The DOM element to append movie cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchDocumentaries(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        try {
            // 1. Fetch general documentaries by genre ID
            const genreUrl = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&with_genres=${TMDB_GENRE_ID_DOCUMENTARY_MOVIE}&sort_by=popularity.desc`;
            const genreResponse = await fetch(genreUrl);
            if (genreResponse.ok) {
                const data = await genreResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'movie' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch general documentaries. Status: ${genreResponse.status}`);
            }

            // 2. Search for specific documentary titles provided by the user
            const specificDocumentaryTitles = [
                'Holding On: A Widowdusk Documentary',
                'Psychic Documentary: Hair-Raising Spiritual Boundary Phenomenon!!',
                'Documentarist', 'Profession: Documentarist', 'The Documentary',
                'Experimental Documentary!! 24-Hour Monitored Lockdown Sex! What Would Happen If You Spent An Entire Day Just Fucking The Shit Out Of Karen', // Explicitly include, but note potential content
                'Documentary of Baby Assassins', 'Sander\'s Documentary',
                'Friday the 13th: From Crystal Lake to Manhattan (Crystal Lake Victims Tell All - Documentary)',
                'Parchís: the Documentary', 'A Documentary on The Shadow Play',
                'GELBOYS Documentary', 'Our Lies and Truths: Documentary of Keyakizaka46',
                'Documentary "Shin Kamen Rider" ~Behind the Scenes of the Hero Action Challenge~',
                'Business as Usual - Documentary', 'EDN | Semper Bichos: Tour Documentary',
                'Semi-documentary: Obscene', // Explicitly include, but note potential content
                'Third Year Debut: The Documentary of Hinatazaka46',
                'Documentary: Cheese Moon',
                'Hidden Scars: The Great Kanto Earthquake Korean Massacre, A Documentary'
            ];

            for (const title of specificDocumentaryTitles) {
                const searchUrl = `${TMDB_BASE_URL}/search/movie?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(title)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0];
                        // Add if it's a movie and its genre includes Documentary or if it's explicitly a documentary in its title
                        if (!fetchedIds.has(topResult.id) && topResult.media_type === 'movie' && 
                           (topResult.genre_ids?.includes(TMDB_GENRE_ID_DOCUMENTARY_MOVIE) || title.toLowerCase().includes('documentary'))) {
                            allResults.push({ ...topResult, media_type: 'movie' });
                            fetchedIds.add(topResult.id);
                        }
                    }
                }
            }


            containerElement.innerHTML = ''; // Clear existing content

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No Documentaries found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Documentaries:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Documentaries.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }


    /**
     * Fetches and populates the Reality TV Shows section, including content
     * featuring Alba Carrillo and specific shows like "Too Hot to Handle: Spain".
     * @param {HTMLElement} containerElement - The DOM element to append show cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchRealityTvShows(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        try {
            // 1. Fetch general Reality TV shows by genre ID
            const genreUrl = `${TMDB_BASE_URL}/discover/tv?api_key=${TMDB_API_KEY}&language=en-US&with_genres=${TMDB_GENRE_ID_REALITY_TV}&sort_by=popularity.desc`;
            const genreResponse = await fetch(genreUrl);
            if (genreResponse.ok) {
                const data = await genreResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'tv' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch general Reality TV shows. Status: ${genreResponse.status}`);
            }

            // 2. Fetch content by Alba Carrillo
            if (TMDB_PERSON_ID_ALBA_CARRILLO) {
                const albaCarrilloCredits = await fetchActorFilmography(TMDB_PERSON_ID_ALBA_CARRILLO, 'tv');
                albaCarrilloCredits.forEach(item => {
                    // Filter to ensure they are TV shows and ideally reality/talk show types
                    if (!fetchedIds.has(item.id) && item.media_type === 'tv' && 
                       (item.genre_ids?.includes(TMDB_GENRE_ID_REALITY_TV) || item.genre_ids?.includes(TMDB_GENRE_ID_TALK_SHOW) || 
                       ['Gran hermano VIP', 'Ven a cenar conmigo: Gourmet Edition', 'Celebrity Bake Off España', 'La Isla de las Tentaciones'].includes(item.name))) {
                        allResults.push(item);
                        fetchedIds.add(item.id);
                    }
                });
            }

            // 3. Search for specific Reality TV show titles provided
            const specificRealityTitles = [
                'Too Hot to Handle: Spain'
            ];
            for (const title of specificRealityTitles) {
                const searchUrl = `${TMDB_BASE_URL}/search/tv?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(title)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0];
                        if (!fetchedIds.has(topResult.id) && topResult.media_type === 'tv' && topResult.genre_ids?.includes(TMDB_GENRE_ID_REALITY_TV)) {
                            allResults.push({ ...topResult, media_type: 'tv' });
                            fetchedIds.add(topResult.id);
                        }
                    }
                }
            }


            containerElement.innerHTML = ''; // Clear existing content

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No Reality TV Shows found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Reality TV Shows:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Reality TV Shows.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }

    /**
     * Fetches and populates the Chinese section, including content featuring
     * Jackie Chan, Donnie Yen, and Jet Li, prioritizing Chinese/Hong Kong origin.
     * @param {HTMLElement} containerElement - The DOM element to append show cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchChineseContent(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        const filterChineseContent = (item) => {
            const isChineseOrigin = item.origin_country?.includes('CN') || item.origin_country?.includes('HK') ||
                                   item.production_countries?.some(pc => pc.iso_3166_1 === 'CN' || pc.iso_3166_1 === 'HK');
            const isChineseLanguage = item.original_language === 'zh' || item.original_language === 'cn' || item.original_language === 'hk';
            // Exclude documentaries about actors unless explicitly relevant to Chinese cinema
            const isDocumentaryAboutActor = item.media_type === 'movie' && item.genre_ids?.includes(TMDB_GENRE_ID_DOCUMENTARY_MOVIE) && (item.title || item.name).toLowerCase().includes('chan');
            
            return (isChineseOrigin || isChineseLanguage) && !isDocumentaryAboutActor;
        };

        try {
            // 1. Fetch general popular Chinese movies/TV shows
            const generalChineseUrl = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&with_original_language=zh&sort_by=popularity.desc`;
            const generalChineseResponse = await fetch(generalChineseUrl);
            if (generalChineseResponse.ok) {
                const data = await generalChineseResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id) && filterChineseContent(item)) {
                        allResults.push({ ...item, media_type: 'movie' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch general Chinese content. Status: ${generalChineseResponse.status}`);
            }

            // 2. Fetch content by Jackie Chan, Donnie Yen, Jet Li
            const chineseActors = [
                TMDB_PERSON_ID_JACKIE_CHAN,
                TMDB_PERSON_ID_DONNIE_YEN,
                TMDB_PERSON_ID_JET_LI
            ];

            for (const personId of chineseActors) {
                const actorCredits = await fetchActorFilmography(personId, 'all');
                actorCredits.forEach(item => {
                    if (!fetchedIds.has(item.id) && filterChineseContent(item)) {
                        allResults.push(item);
                        fetchedIds.add(item.id);
                    }
                });
            }

            // 3. Add specific Chinese/Hong Kong titles mentioned (like Bodyguard from Beijing, Snake Eyes for Japanese)
            const specificChineseTitles = ['Bodyguard from Beijing', 'Snake Eyes'];
            for (const title of specificChineseTitles) {
                const searchUrl = `${TMDB_BASE_URL}/search/multi?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(title)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0];
                        const isJapanese = topResult.original_language === 'ja' || topResult.production_countries?.some(pc => pc.iso_3166_1 === 'JP');
                        
                        // Include if Chinese/HK/Japanese origin, and not already fetched
                        if (!fetchedIds.has(topResult.id) && (filterChineseContent(topResult) || isJapanese)) {
                            allResults.push({ ...topResult, media_type: topResult.media_type || 'movie' });
                            fetchedIds.add(topResult.id);
                        }
                    }
                }
            }


            containerElement.innerHTML = '';

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No Chinese content found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Chinese content:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Chinese content.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }

    /**
     * Fetches and populates the Bollywood section, including content featuring
     * Salman Khan and shows from MBC Bollywood.
     * @param {HTMLElement} containerElement - The DOM element to append show cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchBollywoodContent(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        const filterBollywoodContent = (item) => {
            const isHindiLanguage = item.original_language === 'hi';
            const isIndianOrigin = item.origin_country?.includes('IN') || item.production_countries?.some(pc => pc.iso_3166_1 === 'IN');
            return isHindiLanguage || isIndianOrigin;
        };

        try {
            // 1. Fetch general popular Bollywood movies by Hindi language
            const generalBollywoodUrl = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&with_original_language=hi&sort_by=popularity.desc`;
            const generalBollywoodResponse = await fetch(generalBollywoodUrl);
            if (generalBollywoodResponse.ok) {
                const data = await generalBollywoodResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id) && filterBollywoodContent(item)) {
                        allResults.push({ ...item, media_type: 'movie' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch general Bollywood movies. Status: ${generalBollywoodResponse.status}`);
            }

            // 2. Fetch content by Salman Khan
            if (TMDB_PERSON_ID_SALMAN_KHAN) {
                const salmanKhanCredits = await fetchActorFilmography(TMDB_PERSON_ID_SALMAN_KHAN, 'movie');
                salmanKhanCredits.forEach(item => {
                    if (!fetchedIds.has(item.id) && filterBollywoodContent(item)) {
                        allResults.push(item);
                        fetchedIds.add(item.id);
                    }
                });
            }

            // 3. Fetch TV shows from MBC Bollywood network
            if (TMDB_NETWORK_ID_MBC_BOLLYWOOD) {
                // Fetch details for the network to see if there's a TV endpoint directly for it
                const networkTvUrl = `${TMDB_BASE_URL}/network/${TMDB_NETWORK_ID_MBC_BOLLYWOOD}/tv?api_key=${TMDB_API_KEY}&language=en-US`;
                const networkTvResponse = await fetch(networkTvUrl);
                if (networkTvResponse.ok) {
                    const data = await networkTvResponse.json();
                    data.results.forEach(item => {
                        if (!fetchedIds.has(item.id) && filterBollywoodContent(item)) {
                            allResults.push({ ...item, media_type: 'tv' });
                            fetchedIds.add(item.id);
                        }
                    });
                } else {
                    console.warn(`Could not fetch TV shows for MBC Bollywood network. Status: ${networkTvResponse.status}`);
                }
            }

            // 4. Fetch content by Allu Arjun (assuming for Bollywood section based on user prompt, though he is primarily Telugu)
            // User mentioned Allu Arjun under Bollywood, so I'll fetch his filmography and include if relevant (Indian origin)
            const TMDB_PERSON_ID_ALLU_ARJUN = 104595; // Found this ID via a quick external search
            if (TMDB_PERSON_ID_ALLU_ARJUN) {
                const alluArjunCredits = await fetchActorFilmography(TMDB_PERSON_ID_ALLU_ARJUN, 'movie');
                alluArjunCredits.forEach(item => {
                    if (!fetchedIds.has(item.id) && (item.original_language === 'te' || item.production_countries?.some(pc => pc.iso_3166_1 === 'IN'))) { // Telugu or Indian origin
                        allResults.push(item);
                        fetchedIds.add(item.id);
                    }
                });
            }

            containerElement.innerHTML = '';

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No Bollywood content found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Bollywood content:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Bollywood content.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }


    /**
     * Fetches and populates the K-Drama section, including content featuring
     * Gong Yoo and Lee Jung-jae.
     * @param {HTMLElement} containerElement - The DOM element to append show cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchKDramaContent(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        const filterKoreanContent = (item) => {
            const isKoreanLanguage = item.original_language === 'ko';
            const isKoreanOrigin = item.origin_country?.includes('KR') || item.production_countries?.some(pc => pc.iso_3166_1 === 'KR');
            return isKoreanLanguage || isKoreanOrigin;
        };

        try {
            // 1. Fetch general popular K-Dramas
            const generalKDramaUrl = `${TMDB_BASE_URL}/discover/tv?api_key=${TMDB_API_KEY}&language=en-US&with_original_language=ko&sort_by=popularity.desc`;
            const generalKDramaResponse = await fetch(generalKDramaUrl);
            if (generalKDramaResponse.ok) {
                const data = await generalKDramaResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id) && filterKoreanContent(item)) {
                        allResults.push({ ...item, media_type: 'tv' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch general K-Dramas. Status: ${generalKDramaResponse.status}`);
            }

            // 2. Fetch content by Gong Yoo and Lee Jung-jae
            const kDramaActors = [
                TMDB_PERSON_ID_GONG_YOO,
                TMDB_PERSON_ID_LEE_JUNG_JAE
            ];

            for (const personId of kDramaActors) {
                const actorCredits = await fetchActorFilmography(personId, 'all');
                actorCredits.forEach(item => {
                    if (!fetchedIds.has(item.id) && filterKoreanContent(item)) {
                        allResults.push(item);
                        fetchedIds.add(item.id);
                    }
                });
            }

            // 3. Add specific K-Drama titles mentioned (Squid Game, Xo Kitty, Train to Busan, All of Us Are Dead, Money Heist Korea, Bloodhounds)
            const specificKDramaTitles = [
                'Squid Game', 'XO, Kitty', 'Train to Busan', 'All of Us Are Dead',
                'Money Heist: Korea – Joint Economic Area', 'Bloodhounds'
            ];
            for (const title of specificKDramaTitles) {
                const searchUrl = `${TMDB_BASE_URL}/search/multi?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(title)}`;
                const searchResponse = await fetch(searchUrl);
                if (searchResponse.ok) {
                    const searchData = await searchResponse.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const topResult = searchData.results[0];
                        if (!fetchedIds.has(topResult.id) && filterKoreanContent(topResult)) {
                            allResults.push({ ...topResult, media_type: topResult.media_type || 'tv' });
                            fetchedIds.add(topResult.id);
                        }
                    }
                }
            }


            containerElement.innerHTML = '';

            if (allResults.length > 0) {
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No K-Drama content found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching K-Drama content:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load K-Drama content.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }

    /**
     * Fetches and populates the Hollywood section with both movies and TV shows
     * originating from the USA.
     * @param {HTMLElement} containerElement - The DOM element to append show cards to.
     * @param {number} [requiredCount=20] - The target number of items to fetch.
     * @param {number} [displayLimit=10] - The number of items to display.
     */
    async function fetchHollywoodContent(containerElement, requiredCount = 20, displayLimit = 10) {
        const spinner = containerElement.querySelector('.spinner');
        if (spinner) spinner.style.display = 'block';

        let allResults = [];
        const fetchedIds = new Set();

        try {
            // Fetch popular movies from the USA
            const moviesUrl = `${TMDB_BASE_URL}/discover/movie?api_key=${TMDB_API_KEY}&language=en-US&region=US&sort_by=popularity.desc`;
            const moviesResponse = await fetch(moviesUrl);
            if (moviesResponse.ok) {
                const data = await moviesResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'movie' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch Hollywood movies. Status: ${moviesResponse.status}`);
            }

            // Fetch popular TV shows from the USA
            const tvShowsUrl = `${TMDB_BASE_URL}/discover/tv?api_key=${TMDB_API_KEY}&language=en-US&with_origin_country=US&sort_by=popularity.desc`;
            const tvShowsResponse = await fetch(tvShowsUrl);
            if (tvShowsResponse.ok) {
                const data = await tvShowsResponse.json();
                data.results.forEach(item => {
                    if (!fetchedIds.has(item.id)) {
                        allResults.push({ ...item, media_type: 'tv' });
                        fetchedIds.add(item.id);
                    }
                });
            } else {
                console.warn(`Could not fetch Hollywood TV shows. Status: ${tvShowsResponse.status}`);
            }

            containerElement.innerHTML = ''; // Clear existing content

            if (allResults.length > 0) {
                // Sort by popularity and then slice for display
                allResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
                allResults.slice(0, displayLimit).forEach(show => {
                    const card = createShowCard(show);
                    containerElement.appendChild(card);
                });
            } else {
                containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No Hollywood content found.</p>`;
            }

        } catch (error) {
            console.error(`Error fetching Hollywood content:`, error);
            containerElement.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load Hollywood content.</p>`;
        } finally {
            if (spinner) spinner.style.display = 'none';
        }
    }


    // DOMContentLoaded event listener
    document.addEventListener('DOMContentLoaded', async () => {
        const accountButton = document.getElementById('accountButton');
        const accountDropdown = document.getElementById('accountDropdown');
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const mobileNavLinks = document.getElementById('mobileNavLinks');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const desktopLogoutLink = document.getElementById('desktopLogoutLink'); 
        const mobileLogoutLink = document.getElementById('mobileLogoutLink'); 
        const searchToggleButton = document.getElementById('searchToggleButton');
        const dynamicSearchArea = document.getElementById('dynamicSearchArea');
        const expandedSearchBar = document.getElementById('expandedSearchBar');
        const micIconBtn = document.getElementById('micIconBtn');
        const clearSearchBtn = document.getElementById('clearSearchBtn');
        const searchActionBtn = document.getElementById('searchActionBtn');
        const genreFilter = document.getElementById('genreFilter');
        const yearFilter = document.getElementById('yearFilter');
        const searchSuggestionsContainer = document.getElementById('searchSuggestionsContainer');


        // Helper function to set up carousel
        const setupCarousel = (sectionId, containerId) => {
            const section = document.getElementById(sectionId);
            if (!section) return; // Exit if section doesn't exist

            const carouselInner = section.querySelector('.show-carousel-inner');
            const leftArrow = section.querySelector('.carousel-arrow.left');
            const rightArrow = section.querySelector('.carousel-arrow.right');

            if (carouselInner && leftArrow && rightArrow) {
                leftArrow.addEventListener('click', () => scrollCarousel(carouselInner, 'left'));
                rightArrow.addEventListener('click', () => scrollCarousel(carouselInner, 'right'));
            } else {
                console.warn(`Carousel elements not found for section: ${sectionId}`);
            }
        };


        // Toggles Account Dropdown
        if (accountButton && accountDropdown) {
            accountButton.addEventListener('click', (e) => {
                e.stopPropagation();
                accountDropdown.classList.toggle('show');
            });
            document.addEventListener('click', (e) => {
                if (!accountDropdown.contains(e.target) && !accountButton.contains(e.target)) {
                    accountDropdown.classList.remove('show');
                }
                // Hide search suggestions if clicked outside
                if (searchSuggestionsContainer && !expandedSearchBar.contains(e.target) && !searchSuggestionsContainer.contains(e.target)) {
                    searchSuggestionsContainer.classList.remove('show');
                }
            });
        }

        // Toggles Mobile Menu
        if (mobileMenuToggle && mobileNavLinks) {
            mobileMenuToggle.addEventListener('click', () => {
                mobileNavLinks.classList.toggle('show-mobile-menu');
            });
        }

        // Toggles Dark Mode
        if (darkModeToggle) {
            darkModeToggle.addEventListener('click', toggleDarkMode);
        }

        // Handles Logout functionality (simulated)
        const performLogout = () => {
            showMessageBox('You have been logged out.', 'fas fa-check-circle green-icon');
            updateAccountDropdown(false);
            // Close mobile menu if open after logout
            if (mobileNavLinks) {
                mobileNavLinks.classList.remove('show-mobile-menu');
            }
        };

        if (desktopLogoutLink) {
            desktopLogoutLink.addEventListener('click', (e) => {
                e.preventDefault();
                performLogout();
            });
        }
        if (mobileLogoutLink) {
            mobileLogoutLink.addEventListener('click', (e) => {
                e.preventDefault();
                performLogout();
            });
        }

        // Initializes Dark Mode based on localStorage
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            if (darkModeToggle) {
                darkModeToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun');
                darkModeToggle.setAttribute('aria-label', 'Toggle Light Mode');
                darkModeToggle.setAttribute('title', 'Toggle Light Mode');
            }
        }
        updateAccountDropdown(false); // Initializes account dropdown based on userLoggedIn state (simulated as logged out)

        // Updates the current year in the footer
        const currentYearSpan = document.getElementById('current-year');
        if (currentYearSpan) {
            currentYearSpan.textContent = new Date().getFullYear();
        }

        // Sets Last Modified Date in footer
        const lastModifiedSpan_footer = document.getElementById('last-modified');
        if (lastModifiedSpan_footer) {
            lastModifiedSpan_footer.textContent = new Date(document.lastModified).toLocaleDateString();
        }

        // Handles Dynamic Search Bar Logic
        if (searchToggleButton && dynamicSearchArea && expandedSearchBar && searchActionBtn) {
            searchToggleButton.addEventListener('click', () => {
                const isShowing = dynamicSearchArea.classList.toggle('show');
                if (isShowing) {
                    expandedSearchBar.focus();
                } else {
                    // When hiding, also hide suggestions
                    if (searchSuggestionsContainer) searchSuggestionsContainer.classList.remove('show');
                }
            });

            // Debounced search input for suggestions
            const debouncedSearch = debounce(async (query) => {
                const results = await fetchSearchResults(query);
                displaySearchResults(results);
            }, 300); // 300ms debounce delay

            expandedSearchBar.addEventListener('input', () => {
                const query = expandedSearchBar.value.trim();
                if (query.length > 2) { // Start suggesting after 2 characters
                    debouncedSearch(query);
                } else {
                    if (searchSuggestionsContainer) searchSuggestionsContainer.classList.remove('show');
                }
                // Shows/hides searchActionBtn and manages clearSearchBtn based on input
                if (expandedSearchBar.value.length > 0) {
                    searchActionBtn.style.display = 'inline-block';
                    clearSearchBtn.style.display = 'inline-block';
                } else {
                    searchActionBtn.style.display = 'none';
                    clearSearchBtn.style.display = 'none';
                }
            });

            // Handles clear search button click
            clearSearchBtn.addEventListener('click', () => {
                expandedSearchBar.value = '';
                searchActionBtn.style.display = 'none';
                clearSearchBtn.style.display = 'none';
                if (searchSuggestionsContainer) searchSuggestionsContainer.classList.remove('show');
            });

            // Handles mic icon button click (placeholder)
            micIconBtn.addEventListener('click', () => {
                showMessageBox('Voice search activated. (Functionality not yet implemented)', 'fas fa-microphone blue-icon');
            });

            // index.html

/**
 * Fetches search results and redirects to the top result's detail page.
 */
const performSearch = async () => {
    const query = expandedSearchBar.value.trim();
    if (!query) {
        showMessageBox('Please enter a search term.', 'fas fa-info-circle yellow-icon');
        return;
    }

    // Hide suggestions dropdown
    if (searchSuggestionsContainer) {
        searchSuggestionsContainer.classList.remove('show');
    }

    try {
        // Fetch the search results
        const results = await fetchSearchResults(query);

        if (results && results.length > 0) {
            // Get the first valid result (movie, TV show, or person)
            const topResult = results[0];

            // Check if the top result has a valid media type for the details page
            if (topResult.media_type === 'movie' || topResult.media_type === 'tv' || topResult.media_type === 'person') {
                // Redirect to the details page with the correct ID and type
                window.location.href = `details.html?id=${topResult.id}&type=${topResult.media_type}`;
            } else {
                // Fallback for cases where the top result is not a supported type
                showMessageBox(`No direct match found for "${query}". Try selecting from the suggestions.`, 'fas fa-search blue-icon');
            }
        } else {
            showMessageBox(`No results found for "${query}". Please try a different search term.`, 'fas fa-exclamation-triangle red-icon');
        }
    } catch (error) {
        console.error('Search failed:', error);
        showMessageBox('An error occurred during the search. Please try again.', 'fas fa-server red-icon');
    }
};

// ... inside the DOMContentLoaded event listener ...

searchActionBtn.addEventListener('click', performSearch);
expandedSearchBar.addEventListener('keydown', (event) => {
    if (event.key === 'Enter') {
        performSearch();
    }
});
            // Populates filters on load
            const currentYear = new Date().getFullYear();
            populateYearFilter(yearFilter, 1950, currentYear); // Years from 1950 to current

            // Fetch movie and TV genres and combine them for the general genre filter
            const movieGenres = await fetchGenres('movie');
            const tvGenres = await fetchGenres('tv');
            // Combine and unique genres (by ID)
            const allGenres = [...new Map([...movieGenres, ...tvGenres].map(genre => [genre.id, genre])).values()];
            populateGenreFilter(genreFilter, allGenres);
        } 
        // Ensures search button label and clear button are hidden initially
        if (searchActionBtn) searchActionBtn.style.display = 'none';
        if (clearSearchBtn) clearSearchBtn.style.display = 'none';


        // --- Homepage Content Loading & Carousel Setup ---

        // Load featured content for hero section
        const featuredContent = await fetchFeaturedContent();
        if (featuredContent) {
            populateHeroSection(featuredContent);
        } else {
            document.getElementById('heroTitle').textContent = 'Welcome to CineWatch!';
            document.getElementById('heroSynopsis').textContent = 'Your ultimate destination for movies and TV shows. Start exploring!';
            document.getElementById('heroSection').style.backgroundImage = `linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://placehold.co/1280x720/282828/f0f0f0?text=CineWatch')`;
            document.getElementById('heroWatchNowBtn').style.display = 'none'; // Hide buttons if no content
            document.getElementById('heroAddToWatchlistBtn').style.display = 'none';
        }

        // Define categories with their elements, endpoints, and media types for easy iteration
        // NOTE: Categories that need custom fetch functions (like Swahili, International Hits, Talk Shows)
        // are called directly after this section to ensure they use their specialized logic.
        const categories = [
            { id: 'popularTvSection', containerId: 'popularTvContainer', endpoint: '/tv/popular', mediaType: 'tv' },
            { id: 'trendingMoviesSection', containerId: 'trendingMoviesContainer', endpoint: '/trending/movie/week', mediaType: 'movie' },
            { id: 'newReleasesTvSection', containerId: 'newReleasesTvContainer', endpoint: '/tv/on_the_air', mediaType: 'tv' },
            // Removed documentaries, reality tv, chinese, bollywood, k-drama, swahili, international hits as they now have custom functions
            { id: 'comingSoonSection', containerId: 'comingSoonContainer', endpoint: '/movie/upcoming', mediaType: 'movie' },
            { id: 'seasonFinaleSection', containerId: 'seasonFinaleContainer', endpoint: '/tv/top_rated', mediaType: 'tv' },
            // Updated Hollywood section to use customFetch for combining movies and TV shows from USA
            { id: 'hollywoodSection', containerId: 'hollywoodContainer', customFetch: fetchHollywoodContent, mediaType: 'all' }, 
            // Keeping these generic ones that don't need actor/company specific fetches
            { id: 'warnersBrosSection', containerId: 'warnersBrosContainer', customFetch: fetchWarnerBrosMovies, mediaType: 'movie' },
            { id: 'tylerPerrySection', containerId: 'tylerPerryContainer', customFetch: fetchTylerPerryStudiosMovies, mediaType: 'movie' }
        ];

        const fetchPromises = categories.map(cat => {
            const containerElement = document.getElementById(cat.containerId);
            if (containerElement) {
                if (cat.customFetch) {
                    return cat.customFetch(containerElement, 20, 10);
                } else {
                    return fetchAndPopulateShows(cat.endpoint, containerElement, cat.mediaType, 20, 10); // Fetch 20, display 10
                }
            }
            return Promise.resolve(); // Resolve immediately if element not found
        });

        // Add custom fetch promises for special categories
        fetchPromises.push(fetchDocumentaries(document.getElementById('documentariesContainer'), 20, 10));
        fetchPromises.push(fetchRealityTvShows(document.getElementById('realityTvContainer'), 20, 10));
        fetchPromises.push(fetchTalkShows(document.getElementById('talkShowsContainer'), 20, 10));
        fetchPromises.push(fetchSwahiliAndKenyanShows(document.getElementById('kenyanDramaContainer'), 20, 10)); // Renamed section from swahili to kenyan drama for specific purpose
        fetchPromises.push(fetchKDramaContent(document.getElementById('kDramaContainer'), 20, 10));
        fetchPromises.push(fetchChineseContent(document.getElementById('chineseContainer'), 20, 10));
        fetchPromises.push(fetchBollywoodContent(document.getElementById('bollywoodContainer'), 20, 10));
        fetchPromises.push(fetchInternationalHits(document.getElementById('internationalHitsContainer'), 20, 10));


        await Promise.all(fetchPromises);

        // After populating, set up carousels for all relevant sections
        // Note: The load-more-btn URLs are updated to correctly reflect the new custom fetch functions
        const allCarouselSections = [
            'popularTvSection', 'trendingMoviesSection', 'newReleasesTvSection',
            'documentariesSection', 'realityTvSection', 'talkShowsSection',
            'comingSoonSection', 'seasonFinaleSection', 'kenyanDramaSection',
            'kDramaSection', 'hollywoodSection', 'bollywoodSection',
            'chineseSection', 'swahiliSection', 'internationalHitsSection', // Swahili and Kenyan Drama share the same container
            'warnersBrosSection', 'tylerPerrySection'
        ];

        allCarouselSections.forEach(sectionId => {
            const containerId = sectionId.replace('Section', 'Container'); // Derive container ID
            setupCarousel(sectionId, containerId);
        });
        
    });
  </script>
</body>
</html>