<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popular People | CineWatch</title>
    <meta name="description" content="Discover the most popular actors and personalities in the world of African and international cinema on CineWatch.">
    <meta name="keywords" content="CineWatch, popular people, actors, actresses, directors, cast, crew, film industry, cinema, Hollywood, Nollywood, Riverwood, African film">
    <link rel="icon" type="image/x-icon" href="images/CineWatch-logo.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/colors.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/peoples.css">
    <link rel="stylesheet" href="css/footer.css">
    <style>

    </style>
</head>
<body>
    <div id="header-placeholder"></div>

    <main class="popular-people-page">
        <div class="popular-people-container">
            <h1 class="popular-people-heading">Popular People</h1>
            <p style="font-size: 1.2rem; color: var(--text-secondary);">Browse the most popular actors and directors in the film industry.</p>
            <div id="people-list-container" class="people-grid">
                <!-- Person cards will be dynamically inserted here -->
                <div class="loading-text">Loading popular people...</div>
            </div>
            <button id="loadMoreBtn" class="load-more-btn" style="display: none;">Load More</button>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <button id="scrollToTopBtn" aria-label="Scroll to top">
        <i class="fas fa-chevron-up"></i>
    </button>
    
    <script src="js/header.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
    const peopleListContainer = document.getElementById('people-list-container');
    const loadMoreBtn = document.getElementById('loadMoreBtn');
    const API_KEY = '9c198aabc1df9fa96ea8d65e183cb8a3';
    const BASE_URL = 'https://api.themoviedb.org/3';
    const IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/w500';
    let currentPage = 1;

    // Scroll to Top Button functionality
    const scrollToTopBtn = document.getElementById('scrollToTopBtn');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
            scrollToTopBtn.style.display = 'block';
        } else {
            scrollToTopBtn.style.display = 'none';
        }
    });
    scrollToTopBtn.addEventListener('click', () => {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });

    // Function to fetch popular people from TMDb
    async function fetchPopularPeople(page) {
        try {
            const response = await fetch(`${BASE_URL}/person/popular?api_key=${API_KEY}&page=${page}`);
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            const data = await response.json();
            renderPeopleCards(data.results);
            if (data.total_pages > currentPage) {
                loadMoreBtn.style.display = 'block';
            } else {
                loadMoreBtn.style.display = 'none';
            }
        } catch (error) {
            console.error('Failed to fetch popular people:', error);
            peopleListContainer.innerHTML = `<div class="error-text">Failed to load data. Please try again later.</div>`;
            loadMoreBtn.style.display = 'none';
        }
    }

    // Function to render the person cards
    function renderPeopleCards(people) {
        if (!people || people.length === 0) {
            if (currentPage === 1) {
                peopleListContainer.innerHTML = `<div class="error-text">No popular people found.</div>`;
            }
            loadMoreBtn.style.display = 'none';
            return;
        }

        if (currentPage === 1) {
            peopleListContainer.innerHTML = ''; // Clear loading text on first load
        }
        
        people.forEach(person => {
            const personCard = document.createElement('div');
            personCard.classList.add('person-card');

            // Construct the URL for the detailed page
            const detailsUrl = `cast.html?actorId=${person.id}`;

            const knownForTitles = person.known_for
                .map(item => item.title || item.name)
                .filter(Boolean)
                .slice(0, 3) // Show top 3 known for titles
                .join(', ');

            // ===============================================
            // MODIFIED CODE: Added the new wrapper div
            // ===============================================
            personCard.innerHTML = `
                <a href="${detailsUrl}">
                    <div class="person-photo-wrapper">
                        <img src="${person.profile_path ? IMAGE_BASE_URL + person.profile_path : 'https://placehold.co/500x750/333333/FFFFFF?text=No+Image'}" alt="${person.name}" class="person-photo">
                    </div>
                    <div class="person-info">
                        <h3 class="person-name" title="${person.name}">${person.name}</h3>
                        <p class="person-known-for">${person.known_for_department}</p>
                        <p class="person-details">
                            <strong>Known for:</strong> ${knownForTitles || 'N/A'}
                        </p>
                    </div>
                </a>
            `;
            // ===============================================

            peopleListContainer.appendChild(personCard);
        });
    }

    // Initial fetch
    fetchPopularPeople(currentPage);

    // Load more button functionality
    loadMoreBtn.addEventListener('click', () => {
        currentPage++;
        fetchPopularPeople(currentPage);
    });
});
    </script>
</body>
</html>
